

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>DSCI 572 Lab 1 &#8212; DSCI 572 Supervised Learning II</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'labs/lab1/lab1';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../README.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/mds-hex-sticker.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/mds-hex-sticker.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Lectures</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../lectures/01_floating-point-numbers.html">Lecture 1: Floating-Point Numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lectures/02_gradient-descent.html">Lecture 2: Optimization &amp; Gradient Descent</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lectures/03_sgd-intro-to-nn.html">Lecture 3: Stochastic Gradient Descent and Introduction to Neural Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lectures/04_pytorch-neural-networks-pt1.html">Lecture 4: Introduction to Pytorch &amp; Neural Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lectures/05_neural-networks-pt2.html">Lecture 5: Training Neural Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lectures/06_cnns-pt1.html">Lecture 6: Introduction to Convolutional Neural Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lectures/07_cnns-pt2.html">Lecture 7: CNNs in Practice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lectures/08_advanced-deep-learning.html">Lecture 8: Advanced Convolutional Models</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../lectures/appendixA_gradients.html">Appendix A: Gradients Review</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lectures/appendixB_logistic-loss.html">Appendix B: Logistic Loss</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lectures/appendixC_computing-derivatives.html">Appendix C: Computing Derivatives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lectures/appendixD_bitmoji-CNN.html">Appendix D: Creating a CNN to Predict Bitmojis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Attribution</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../LICENSE.html">LICENSE</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/UBC-MDS/DSCI_572_sup-learn-2" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/labs/lab1/lab1.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>DSCI 572 Lab 1</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-exercise-0-gradients-of-mathematical-functions">(optional) Exercise 0: gradients of mathematical functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-gradients-of-python-functions">Exercise 1: gradients of Python functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a">1(a)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#b">1(b)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#c">1(c)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-1-d">(optional) 1(d)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-1-e">(optional) 1(e)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2-gradient-descent">Exercise 2: gradient descent</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3-logistic-regression">Exercise 3: logistic regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">3(a)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">3(b)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">3(c)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#d">3(d)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-3-e">(optional) 3(e)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#f">3(f)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4-scikit-learn-logistic-regression">Exercise 4: scikit-learn logistic regression</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="dsci-572-lab-1">
<h1>DSCI 572 Lab 1<a class="headerlink" href="#dsci-572-lab-1" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">minimize</span><span class="p">,</span> <span class="n">check_grad</span>

<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">CountVectorizer</span>
</pre></div>
</div>
</div>
</div>
<section id="optional-exercise-0-gradients-of-mathematical-functions">
<h2>(optional) Exercise 0: gradients of mathematical functions<a class="headerlink" href="#optional-exercise-0-gradients-of-mathematical-functions" title="Permalink to this heading">#</a></h2>
<p>rubric={raw:7}</p>
<p>Compute the gradient of each of the following mathematical functions. The notation for the gradient of a function <span class="math notranslate nohighlight">\(f\)</span> is <span class="math notranslate nohighlight">\(\nabla f(x)\)</span>. Note that <span class="math notranslate nohighlight">\(x\)</span> may be a vector but <span class="math notranslate nohighlight">\(f\)</span> returns a scalar in all the cases below. The gradient is also a vector.</p>
<p>In some cases, the dimensionality of <span class="math notranslate nohighlight">\(x\)</span> is provided: for example</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(x \in \mathbb{R}^3\)</span></p>
</div></blockquote>
<p>means that <span class="math notranslate nohighlight">\(x\)</span> is a vector with 3 elements. In other cases, you should be able to infer the dimension from the context (for example, for <span class="math notranslate nohighlight">\(f_2\)</span> we can infer that <span class="math notranslate nohighlight">\(x \in \mathbb{R}^2\)</span> since otherwise the matrix multiplication wouldn’t make sense). Finally, in some cases (like <span class="math notranslate nohighlight">\(f_6\)</span>) the dimension is unknown but you should be able to give an answer that holds regardless of the dimension of <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p>Hint: for <span class="math notranslate nohighlight">\(\nabla f_5(x)\)</span> you can write <span class="math notranslate nohighlight">\(x^\top A x\)</span> as a sum of a few terms. Try taking the derivative, and then putting it back into vector notation at the end.</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(f_1(x) = \sin(x)\)</span> where <span class="math notranslate nohighlight">\(x\in \mathbb{R}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(f_2(x) = [0\;\; 1]x\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(f_3(x) = \exp(x_1 + x_2x_3)\)</span> where <span class="math notranslate nohighlight">\(x \in \mathbb{R}^3\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(f_4(x) = \exp(x_1 + x_2x_3)\)</span> where <span class="math notranslate nohighlight">\(x \in \mathbb{R}^4\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(f_5(x) = x^\top A x\)</span> where <span class="math notranslate nohighlight">\(A=\left[ \begin{array}{cc}1 &amp; 2 \\0 &amp; -3 \end{array} \right]\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(f_6(x) = x^\top x\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(f_7(x) = x_1^2\sin(x_2)\)</span> where <span class="math notranslate nohighlight">\(x \in \mathbb{R}^2\)</span></p></li>
</ol>
</section>
<section id="exercise-1-gradients-of-python-functions">
<h2>Exercise 1: gradients of Python functions<a class="headerlink" href="#exercise-1-gradients-of-python-functions" title="Permalink to this heading">#</a></h2>
<p>Write a Python function that computes the gradient of each of the following Python functions.</p>
<p>Notes:</p>
<ul class="simple">
<li><p>All of the functions we deal with here return a scalar, regardless of the size of the input vector <code class="docutils literal notranslate"><span class="pre">x</span></code>. We will not consider the case where the output itself is a vector, since it is not relevant for our context of loss function minimization.</p></li>
<li><p>You do not need to consider the case where <code class="docutils literal notranslate"><span class="pre">x.ndim</span></code> is 2 (or higher); assume <code class="docutils literal notranslate"><span class="pre">x.ndim</span></code> is always 1.</p></li>
<li><p>You do not need to write docstrings for your functions.</p></li>
<li><p>You can use <a class="reference external" href="http://docs.scipy.org/doc/scipy-0.17.0/reference/generated/scipy.optimize.check_grad.html">scipy gradient checker</a> to check your results for a few values of the inputs, as shown in the example below.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># EXAMPLE</span>
<span class="k">def</span> <span class="nf">example</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">example_grad</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">x</span>

<span class="k">def</span> <span class="nf">check_grad_and_print</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">fun_grad</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">dims</span><span class="p">)</span>
    <span class="n">fg</span> <span class="o">=</span> <span class="n">fun_grad</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fg</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Gradient should be a numpy array&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fg</span><span class="p">)</span> <span class="o">!=</span> <span class="n">dims</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Gradient is the wrong size&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    
    <span class="n">diff</span> <span class="o">=</span> <span class="n">check_grad</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">fun_grad</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x0</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">diff</span> <span class="o">&lt;</span> <span class="mf">1e-5</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Success (probably)&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Gradient incorrect (probably)&#39;</span><span class="p">)</span>
        
<span class="n">check_grad_and_print</span><span class="p">(</span><span class="n">example</span><span class="p">,</span> <span class="n">example_grad</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="a">
<h2>1(a)<a class="headerlink" href="#a" title="Permalink to this heading">#</a></h2>
<p>rubric={accuracy:5}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">foo_grad</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    

<span class="n">check_grad_and_print</span><span class="p">(</span><span class="n">foo</span><span class="p">,</span> <span class="n">foo_grad</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="b">
<h2>1(b)<a class="headerlink" href="#b" title="Permalink to this heading">#</a></h2>
<p>rubric={accuracy:5}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pin</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">pin_grad</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    

<span class="n">check_grad_and_print</span><span class="p">(</span><span class="n">pin</span><span class="p">,</span> <span class="n">pin_grad</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="c">
<h2>1(c)<a class="headerlink" href="#c" title="Permalink to this heading">#</a></h2>
<p>rubric={accuracy:5}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">zap</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span><span class="nd">@x</span> <span class="c1"># this is matrix multiplication; equivalent to %*% in R.</span>

<span class="k">def</span> <span class="nf">zap_grad</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    

<span class="n">check_grad_and_print</span><span class="p">(</span><span class="n">zap</span><span class="p">,</span> <span class="n">zap_grad</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="optional-1-d">
<h2>(optional) 1(d)<a class="headerlink" href="#optional-1-d" title="Permalink to this heading">#</a></h2>
<p>rubric={accuracy:1}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">baz</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="n">i</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="k">def</span> <span class="nf">baz_grad</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    

<span class="n">check_grad_and_print</span><span class="p">(</span><span class="n">baz</span><span class="p">,</span> <span class="n">baz_grad</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="optional-1-e">
<h2>(optional) 1(e)<a class="headerlink" href="#optional-1-e" title="Permalink to this heading">#</a></h2>
<p>rubric={accuracy:1}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bar</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">bar_grad</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    
    
<span class="n">check_grad_and_print</span><span class="p">(</span><span class="n">bar</span><span class="p">,</span> <span class="n">bar_grad</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-2-gradient-descent">
<h2>Exercise 2: gradient descent<a class="headerlink" href="#exercise-2-gradient-descent" title="Permalink to this heading">#</a></h2>
<p>rubric={accuracy:10}</p>
<p>Complete the <code class="docutils literal notranslate"><span class="pre">gradient_descent</span></code> function below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">gradient_descent</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">f_grad</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">α</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">ϵ</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Minimizes the function f given the function itself, </span>
<span class="sd">    its gradient, and a starting point.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    f : function</span>
<span class="sd">        the objective</span>
<span class="sd">    f_grad : function</span>
<span class="sd">        the gradient</span>
<span class="sd">    x0 : numpy.ndarray</span>
<span class="sd">        the starting point</span>
<span class="sd">    α : float (optional, default=0.01)</span>
<span class="sd">        the learning rate</span>
<span class="sd">    ϵ : float (optional, default=0.01)</span>
<span class="sd">        the tolerance for termination</span>
<span class="sd">    verbose : bool (optional, default=False)</span>
<span class="sd">        whether or not to print out extra output</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    numpy.ndarray</span>
<span class="sd">        the minimizer of f</span>
<span class="sd">        </span>
<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    &gt;&gt;&gt; gradient_descent(lambda x: x**2, lambda x: 2*x, 1.0, ϵ=1e-6)</span>
<span class="sd">    4.990720528955806e-07</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x0</span>
    
    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">f_grad</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">ϵ</span><span class="p">:</span>
        <span class="c1"># YOUR CODE HERE</span>
        
        
        <span class="k">if</span> <span class="n">verbose</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iter =&quot;</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;||∇f|| =&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">f_grad</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;f =&quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        
        <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">x</span>
</pre></div>
</div>
</div>
</div>
<p>The code below tests your function by comparing the results to <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html#scipy.optimize.minimize"><code class="docutils literal notranslate"><span class="pre">scipy.optimize.minimize</span></code></a>. You should get similar results.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">gradient_descent</span><span class="p">(</span><span class="n">pin</span><span class="p">,</span> <span class="n">pin_grad</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">ϵ</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">minimize</span><span class="p">(</span><span class="n">pin</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">jac</span><span class="o">=</span><span class="n">pin_grad</span><span class="p">)</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-3-logistic-regression">
<h2>Exercise 3: logistic regression<a class="headerlink" href="#exercise-3-logistic-regression" title="Permalink to this heading">#</a></h2>
<p>The code below loads <a class="reference external" href="https://www.kaggle.com/utathya/imdb-review-dataset">the IMDB dataset</a> from DSCI 571, with positive reviews encoded as <span class="math notranslate nohighlight">\(y=+1\)</span> and negative reviews encoded as <span class="math notranslate nohighlight">\(y=-1\)</span>. You’ll need the file <code class="docutils literal notranslate"><span class="pre">imdb_master.csv</span></code> in the current directory, or you can modify the path in <code class="docutils literal notranslate"><span class="pre">read_csv</span></code> below to where you have the file stored. As a reminder, <strong>please do not commit/push this file</strong>. I have attempted to seed your repos with a <code class="docutils literal notranslate"><span class="pre">.gitignore</span></code> file to this effect.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">imdb_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;imdb_master.csv&#39;</span><span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="s2">&quot;ISO-8859-1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">transform_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">split</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span>
                   <span class="n">labels</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;pos&#39;</span><span class="p">,</span><span class="s1">&#39;neg&#39;</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrangles the imdb_master data set into a test or train</span>
<span class="sd">    split and takes a sample size. Returns a dataframe of the</span>
<span class="sd">    single column &quot;review&quot;and an array of the numerical </span>
<span class="sd">    representation of it&#39;s class label.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df : pandas.core.frame.DataFrame</span>
<span class="sd">        the objective</span>
<span class="sd">    split : str</span>
<span class="sd">        the split desired either train or test.</span>
<span class="sd">    sample_size : int (default : 5000)</span>
<span class="sd">        the sample size from the split</span>
<span class="sd">    labels : tuple, optional</span>
<span class="sd">        the classification labels (default : (&#39;pos&#39;,&#39;neg&#39;))</span>
<span class="sd">    (default : &quot;review&quot; )</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    X: pandas.core.frame.DataFrame</span>
<span class="sd">        a dataframe of the imdb review column and index</span>
<span class="sd">    y: numpy.ndarray</span>
<span class="sd">        the class labels </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># get only the positive and negative reviews</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">labels</span><span class="p">)]</span>
    
    <span class="c1"># grab either the train or the test</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">split</span><span class="p">]</span> 
    
    <span class="c1"># subset the rows</span>
    <span class="n">df_subset</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    
    <span class="c1"># X is the reviews</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">df_subset</span><span class="p">[</span><span class="s2">&quot;review&quot;</span><span class="p">]</span>
    
    <span class="c1"># y is the labels, as either -1 or +1</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_subset</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">==</span> <span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span>
    <span class="k">return</span> <span class="n">X</span> <span class="p">,</span> <span class="n">y</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train_reviews</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">transform_df</span><span class="p">(</span><span class="n">imdb_df</span><span class="p">,</span> <span class="s2">&quot;train&quot;</span><span class="p">)</span>
<span class="n">X_test_reviews</span><span class="p">,</span>   <span class="n">y_test</span>  <span class="o">=</span> <span class="n">transform_df</span><span class="p">(</span><span class="n">imdb_df</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span> <span class="p">)</span>

<span class="n">countvec</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">max_features</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">stop_words</span><span class="o">=</span><span class="s1">&#39;english&#39;</span><span class="p">,</span> <span class="n">binary</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="n">countvec</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train_reviews</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">countvec</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test_reviews</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>

<span class="c1"># Note: dataset is small enough that we don&#39;t need to bother with a sparse matrix, hence toarray()</span>
</pre></div>
</div>
</div>
</div>
<p>In this exercise, you’ll implement a logistic regression classifier “from scratch”. You’ll implement the <code class="docutils literal notranslate"><span class="pre">fit</span></code> function using <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html"><code class="docutils literal notranslate"><span class="pre">scipy.optimize.minimize</span></code></a>, which does something similar to your <code class="docutils literal notranslate"><span class="pre">gradient_descent</span></code> function above (but fancier).</p>
<section id="id1">
<h3>3(a)<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<p>rubric={accuracy:10,quality:10}</p>
<p>Complete the <code class="docutils literal notranslate"><span class="pre">fit</span></code> function, using <code class="docutils literal notranslate"><span class="pre">scipy.optimize.minimize</span></code> to solve the optimization problem.</p>
<p>Notes:</p>
<ul class="simple">
<li><p>There’s no “intercept”. This is just for simplicity. It is easy to add in a way that will shortly be explained in DSCI 573.</p></li>
<li><p>I suggest initializing your weights to all zeros.</p></li>
<li><p>You should pass in the gradient to <code class="docutils literal notranslate"><span class="pre">minimize</span></code> using the <code class="docutils literal notranslate"><span class="pre">jac</span></code> argument.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">loss_lr</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="n">X</span><span class="nd">@w</span><span class="p">))))</span>

<span class="k">def</span> <span class="nf">loss_lr_grad</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">X</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="p">(</span><span class="n">y</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="n">X</span><span class="nd">@w</span><span class="p">))))</span>

<span class="k">class</span> <span class="nc">MyLogisticRegression</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">X</span><span class="nd">@self</span><span class="o">.</span><span class="n">w</span><span class="p">)</span>

    <span class="c1"># Fits the regression coefficients for a logistic regression model given the data X, y</span>
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="c1"># YOUR CODE AND DOCSTRING HERE</span>
        
        
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># check gradient of loss</span>
<span class="n">grad_checker</span> <span class="o">=</span> <span class="n">check_grad</span><span class="p">(</span><span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">loss_lr</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> 
                              <span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">loss_lr_grad</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> 
                              <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grad_checker</span><span class="p">,</span> <span class="s2">&quot;&lt;-- should be small&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h3>3(b)<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h3>
<p>rubric={reasoning:2}</p>
<p>Report your training and test error.</p>
</section>
</section>
<section id="id3">
<h2>3(c)<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h2>
<p>rubric={reasoning:2}</p>
<p>Report a confusion matrix for both train and test.</p>
</section>
<section id="d">
<h2>3(d)<a class="headerlink" href="#d" title="Permalink to this heading">#</a></h2>
<p>rubric={reasoning:5}</p>
<p>Find one false positive case and one false negative case in the test set. Print out the corresponding reviews. Discuss your results.</p>
</section>
<section id="optional-3-e">
<h2>(optional) 3(e)<a class="headerlink" href="#optional-3-e" title="Permalink to this heading">#</a></h2>
<p>rubric={reasoning:1}</p>
<p>To explore this further, pick a false positive and false negative example. Then, for each one, see what words (features) are present, and then print out the weights from the model corresponding to those words. Does your false positive example indeed contain many “positive” words, and vice versa for your false negative example? Discuss.</p>
<section id="f">
<h3>3(f)<a class="headerlink" href="#f" title="Permalink to this heading">#</a></h3>
<p>rubric={accuracy:5,reasoning:10}</p>
<p>Adapt your code to use your <code class="docutils literal notranslate"><span class="pre">gradient_descent</span></code> function instead of <code class="docutils literal notranslate"><span class="pre">scipy.optimize.minimize</span></code>. Try using <span class="math notranslate nohighlight">\(\alpha=10^{-4}\)</span> and <span class="math notranslate nohighlight">\(\epsilon=1\)</span>. Do you get similar results to what you got with <code class="docutils literal notranslate"><span class="pre">scipy.optimize.minimize</span></code>?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyLogisticRegressionGD</span><span class="p">:</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span> <span class="c1"># whether to print stuff out during gradient descent</span>

    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">X</span><span class="nd">@self</span><span class="o">.</span><span class="n">w</span><span class="p">)</span>

    <span class="c1"># Fits the regression coefficients for a logistic regression model given the data X, y</span>
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="exercise-4-scikit-learn-logistic-regression">
<h2>Exercise 4: scikit-learn logistic regression<a class="headerlink" href="#exercise-4-scikit-learn-logistic-regression" title="Permalink to this heading">#</a></h2>
<p>rubric={reasoning:15}</p>
<p>The scikit-learn implementation of logistic regression, which we looked at in DSCI 571, can be found <a class="reference external" href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html">here</a>. Compare your implementation to the sklearn one, both in terms of speed and accuracy, on the same problem as above. For a fair comparison, use the following hyperparameters with scikit-learn’s <code class="docutils literal notranslate"><span class="pre">LogisticRegression</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">C=1e8</span></code> to (mostly) disable regularization for sklearn, since your implementation doesn’t use regularization.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fit_intercept=False</span></code> since your code above doesn’t fit an intercept term.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">solver=&quot;lbfgs&quot;</span></code> just in case your scikit-learn version is older than 0.22 (<code class="docutils literal notranslate"><span class="pre">minimize</span></code> is probably using <a class="reference external" href="https://en.wikipedia.org/wiki/Limited-memory_BFGS">L-BFGS</a> also.)</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./labs/lab1"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-exercise-0-gradients-of-mathematical-functions">(optional) Exercise 0: gradients of mathematical functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-gradients-of-python-functions">Exercise 1: gradients of Python functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a">1(a)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#b">1(b)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#c">1(c)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-1-d">(optional) 1(d)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-1-e">(optional) 1(e)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2-gradient-descent">Exercise 2: gradient descent</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3-logistic-regression">Exercise 3: logistic regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">3(a)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">3(b)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">3(c)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#d">3(d)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-3-e">(optional) 3(e)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#f">3(f)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4-scikit-learn-logistic-regression">Exercise 4: scikit-learn logistic regression</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Varada Kolhatkar
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>